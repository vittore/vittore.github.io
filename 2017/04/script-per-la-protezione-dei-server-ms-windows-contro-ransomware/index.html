<!doctype html>
<html class="no-js" lang="it">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Script per la protezione dei server MS windows contro ransomware</title>

    <link rel="stylesheet" type="text/css" href="http://localhost:4000/assets/css/styles_feeling_responsive.css">

  

	<script src="http://localhost:4000/assets/js/modernizr.min.js"></script>

	<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
	<script>
		WebFont.load({
			google: {
				families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ]
			}
		});
	</script>

	<noscript>
		<link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic%7CVolkhov' rel='stylesheet' type='text/css'>
	</noscript>


	<!-- Search Engine Optimization -->
	<meta name="description" content="Con un server Microsoft dalla versione 2008 è possibile usare il servizio FSRM e la funzionalità di screening per proteggere i file contro i client infettati da ransomware. Questa strategia è descritta in talk e in articoli, si veda ad esempio https://blog.netwrix.com/2016/04/11/ransomware-protection-using-fsrm-and-powershell/

Ma gli informatici sono pigri e soprattutto odiano i lavori ripetitivi, per questo ecco lo script che fa tutto il lavoro di installazione e configurazione. Salvatelo su un server ed eseguitelo.

http://www.zen.pn.it/DeployCryptoBlocker.ps1

Lo script:


  Controlla se ci sono condivisioni di rete
  Installa FSRM se non c’è
  Crea gli script batch / PowerShell utilizzati da FSRM
  Crea un gruppo di file in FSRM contenente le estensioni dannose e nomi di file (scaricati in automatico da https://fsrm.experiant.ca/api/v1/get)
  Crea uno screening dei file in FSRM utilizzando questo gruppo di file con una notifica di evento, la notifica con una email all’amministratore
  Crea Screening dei file utilizzando questo modello per ciascuna unità contenente le condivisioni di rete


Come funziona

Se l’utente scrive un file dannoso in una condivisione di rete, FSRM eseguirà lo script che aggiungerà un permesso negato per l’utente.

Con questo script un ransomware al massimo finisce per cifrare una directory prima che l’utente venga bloccato.

NOTA: Questo script non considera le varianti che utilizzano le estensioni dei file randomizzati.

Lo script invia anche una email di alert. Ricordarsi di configurare correttamente il server SMTP (in Strumenti di amministrazione &amp;gt; Gestione risorse file server &amp;gt; Configura opzioni



 

Nota:

In alcune installazioni è possibile che lo script non venga eseguito a causa delle restrizioni sulla firma digitale.

Se vi fidate del mio script potete disabilitare l’esecuzione del controllo digitando nella finestra power shell il comando:

Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass

Fonti:


  Come usare Windows Auditing per fermare i CryptoVirus
  Anti-Ransomware File System Resource Manager Lists
  Updated: How to use File Screening to help block CryptoLocker
  CryptoBlocker">
	
	
	
	
	
	
	<link rel="canonical" href="http://localhost:4000/2017/04/script-per-la-protezione-dei-server-ms-windows-contro-ransomware/">


	<!-- Facebook Open Graph -->
	<meta property="og:title" content="Script per la protezione dei server MS windows contro ransomware">
	<meta property="og:description" content="Con un server Microsoft dalla versione 2008 è possibile usare il servizio FSRM e la funzionalità di screening per proteggere i file contro i client infettati da ransomware. Questa strategia è descritta in talk e in articoli, si veda ad esempio https://blog.netwrix.com/2016/04/11/ransomware-protection-using-fsrm-and-powershell/

Ma gli informatici sono pigri e soprattutto odiano i lavori ripetitivi, per questo ecco lo script che fa tutto il lavoro di installazione e configurazione. Salvatelo su un server ed eseguitelo.

http://www.zen.pn.it/DeployCryptoBlocker.ps1

Lo script:


  Controlla se ci sono condivisioni di rete
  Installa FSRM se non c’è
  Crea gli script batch / PowerShell utilizzati da FSRM
  Crea un gruppo di file in FSRM contenente le estensioni dannose e nomi di file (scaricati in automatico da https://fsrm.experiant.ca/api/v1/get)
  Crea uno screening dei file in FSRM utilizzando questo gruppo di file con una notifica di evento, la notifica con una email all’amministratore
  Crea Screening dei file utilizzando questo modello per ciascuna unità contenente le condivisioni di rete


Come funziona

Se l’utente scrive un file dannoso in una condivisione di rete, FSRM eseguirà lo script che aggiungerà un permesso negato per l’utente.

Con questo script un ransomware al massimo finisce per cifrare una directory prima che l’utente venga bloccato.

NOTA: Questo script non considera le varianti che utilizzano le estensioni dei file randomizzati.

Lo script invia anche una email di alert. Ricordarsi di configurare correttamente il server SMTP (in Strumenti di amministrazione &amp;gt; Gestione risorse file server &amp;gt; Configura opzioni



 

Nota:

In alcune installazioni è possibile che lo script non venga eseguito a causa delle restrizioni sulla firma digitale.

Se vi fidate del mio script potete disabilitare l’esecuzione del controllo digitando nella finestra power shell il comando:

Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass

Fonti:


  Come usare Windows Auditing per fermare i CryptoVirus
  Anti-Ransomware File System Resource Manager Lists
  Updated: How to use File Screening to help block CryptoLocker
  CryptoBlocker">
	<meta property="og:url" content="http://localhost:4000/2017/04/script-per-la-protezione-dei-server-ms-windows-contro-ransomware/">
	<meta property="og:locale" content="en_EN">
	<meta property="og:type" content="website">
	<meta property="og:site_name" content="zen.pn.it - Tecnologia e dintorni">
	
	<meta property="article:author" content="https://www.facebook.com/vittore.zen">


	
	<!-- Twitter -->
	<meta name="twitter:card" content="summary">
	<meta name="twitter:site" content="vittore">
	<meta name="twitter:creator" content="vittore">
	<meta name="twitter:title" content="Script per la protezione dei server MS windows contro ransomware">
	<meta name="twitter:description" content="Con un server Microsoft dalla versione 2008 è possibile usare il servizio FSRM e la funzionalità di screening per proteggere i file contro i client infettati da ransomware. Questa strategia è descritta in talk e in articoli, si veda ad esempio https://blog.netwrix.com/2016/04/11/ransomware-protection-using-fsrm-and-powershell/

Ma gli informatici sono pigri e soprattutto odiano i lavori ripetitivi, per questo ecco lo script che fa tutto il lavoro di installazione e configurazione. Salvatelo su un server ed eseguitelo.

http://www.zen.pn.it/DeployCryptoBlocker.ps1

Lo script:


  Controlla se ci sono condivisioni di rete
  Installa FSRM se non c’è
  Crea gli script batch / PowerShell utilizzati da FSRM
  Crea un gruppo di file in FSRM contenente le estensioni dannose e nomi di file (scaricati in automatico da https://fsrm.experiant.ca/api/v1/get)
  Crea uno screening dei file in FSRM utilizzando questo gruppo di file con una notifica di evento, la notifica con una email all’amministratore
  Crea Screening dei file utilizzando questo modello per ciascuna unità contenente le condivisioni di rete


Come funziona

Se l’utente scrive un file dannoso in una condivisione di rete, FSRM eseguirà lo script che aggiungerà un permesso negato per l’utente.

Con questo script un ransomware al massimo finisce per cifrare una directory prima che l’utente venga bloccato.

NOTA: Questo script non considera le varianti che utilizzano le estensioni dei file randomizzati.

Lo script invia anche una email di alert. Ricordarsi di configurare correttamente il server SMTP (in Strumenti di amministrazione &amp;gt; Gestione risorse file server &amp;gt; Configura opzioni



 

Nota:

In alcune installazioni è possibile che lo script non venga eseguito a causa delle restrizioni sulla firma digitale.

Se vi fidate del mio script potete disabilitare l’esecuzione del controllo digitando nella finestra power shell il comando:

Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass

Fonti:


  Come usare Windows Auditing per fermare i CryptoVirus
  Anti-Ransomware File System Resource Manager Lists
  Updated: How to use File Screening to help block CryptoLocker
  CryptoBlocker">
	
	

	<link type="text/plain" rel="author" href="http://localhost:4000/humans.txt">

	

	

	<link rel="icon" sizes="32x32" href="http://localhost:4000/assets/img/favicon-32x32.png">

	<link rel="icon" sizes="192x192" href="http://localhost:4000/assets/img/touch-icon-192x192.png">

	<link rel="apple-touch-icon-precomposed" sizes="180x180" href="http://localhost:4000/assets/img/apple-touch-icon-180x180-precomposed.png">

	<link rel="apple-touch-icon-precomposed" sizes="152x152" href="http://localhost:4000/assets/img/apple-touch-icon-152x152-precomposed.png">

	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/assets/img/apple-touch-icon-144x144-precomposed.png">

	<link rel="apple-touch-icon-precomposed" sizes="120x120" href="http://localhost:4000/assets/img/apple-touch-icon-120x120-precomposed.png">

	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/assets/img/apple-touch-icon-114x114-precomposed.png">

	
	<link rel="apple-touch-icon-precomposed" sizes="76x76" href="http://localhost:4000/assets/img/apple-touch-icon-76x76-precomposed.png">

	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/assets/img/apple-touch-icon-72x72-precomposed.png">

	<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/assets/img/apple-touch-icon-precomposed.png">	

	<meta name="msapplication-TileImage" content="http://localhost:4000/assets/img/msapplication_tileimage.png">

	<meta name="msapplication-TileColor" content="#fabb00">


	

</head>
<body id="top-of-page" class="post">
	
	
<div id="navigation" class="sticky">
  <nav class="top-bar" role="navigation" data-topbar>
    <ul class="title-area">
      <li class="name">
      <h1 class="show-for-small-only"><a href="http://localhost:4000" class="icon-tree"> zen.pn.it - Tecnologia e dintorni</a></h1>
    </li>
       <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
      <li class="toggle-topbar menu-icon"><a href="#"><span>Nav</span></a></li>
    </ul>
    <section class="top-bar-section">

      <ul class="right">
        

              

          
          
        

              

          
          
        

              

          
          
        

              

          
          
        

              

          
          
        
        
      </ul>

      <ul class="left">
        

              

          
          

            
            
              <li><a  href="http://localhost:4000/">Home</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          

            
            
              <li><a  href="http://localhost:4000/chi-sono/">Chi sono</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          

            
            
              <li><a  href="http://localhost:4000/perché-questo-blog/">Perché questo blog</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          

            
            
              <li><a  href="http://localhost:4000/contatti/">Contatti</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          

            
            
              <li><a  href="http://localhost:4000/whishlist/">Whishlist</a></li>
              <li class="divider"></li>

            
            
          
        
        
      </ul>
    </section>
  </nav>
</div><!-- /#navigation -->

	

	

<div id="masthead-no-image-header">
	<div class="row">
		<div class="small-12 columns">
			<a id="logo" href="http://localhost:4000/" title="zen.pn.it - Tecnologia e dintorni – Segnalazioni e riflessioni su &quot;cose di tecnologia&quot; di Vittore Zen">
				<img src="http://localhost:4000/assets/img/logo.png" alt="zen.pn.it - Tecnologia e dintorni – Segnalazioni e riflessioni su &quot;cose di tecnologia&quot; di Vittore Zen">
			</a>
		</div><!-- /.small-12.columns -->
	</div><!-- /.row -->
</div><!-- /#masthead -->









	<div class="row t30">
	<div class="medium-8 columns medium-offset-2 end">
		<article itemscope itemtype="http://schema.org/Article">
			<header>
				

				<div itemprop="name">
					
					<h1>Script per la protezione dei server MS windows contro ransomware</h1>
				</div>
			</header>


			

			<div itemprop="articleSection">
			<p>Con un server Microsoft dalla versione 2008 è possibile usare il servizio FSRM e la funzionalità di screening per proteggere i file contro i client infettati da ransomware. Questa strategia è descritta in talk e in articoli, si veda ad esempio <a href="https://blog.netwrix.com/2016/04/11/ransomware-protection-using-fsrm-and-powershell/">https://blog.netwrix.com/2016/04/11/ransomware-protection-using-fsrm-and-powershell/</a></p>

<p>Ma gli informatici sono pigri e soprattutto odiano i lavori ripetitivi, per questo ecco lo script che fa tutto il lavoro di installazione e configurazione. Salvatelo su un server ed eseguitelo.</p>

<p><a href="http://www.zen.pn.it/DeployCryptoBlocker.ps1">http://www.zen.pn.it/DeployCryptoBlocker.ps1</a></p>

<p>Lo script:</p>

<ul>
  <li>Controlla se ci sono condivisioni di rete</li>
  <li>Installa FSRM se non c’è</li>
  <li>Crea gli script batch / PowerShell utilizzati da FSRM</li>
  <li>Crea un gruppo di file in FSRM contenente le estensioni dannose e nomi di file (scaricati in automatico da <a href="https://fsrm.experiant.ca/api/v1/get">https://fsrm.experiant.ca/api/v1/get</a>)</li>
  <li>Crea uno screening dei file in FSRM utilizzando questo gruppo di file con una notifica di evento, la notifica con una email all’amministratore</li>
  <li>Crea Screening dei file utilizzando questo modello per ciascuna unità contenente le condivisioni di rete</li>
</ul>

<h2 id="come-funziona">Come funziona</h2>

<p>Se l’utente scrive un file dannoso in una condivisione di rete, FSRM eseguirà lo script che aggiungerà un permesso negato per l’utente.</p>

<p>Con questo script un ransomware al massimo finisce per cifrare una directory prima che l’utente venga bloccato.</p>

<p>NOTA: Questo script non considera le varianti che utilizzano le estensioni dei file randomizzati.</p>

<p>Lo script invia anche una email di alert. Ricordarsi di configurare correttamente il server SMTP (in Strumenti di amministrazione &gt; Gestione risorse file server &gt; Configura opzioni</p>

<p><a href="https://i1.wp.com/www.zen.pn.it/wp-content/uploads/2017/04/Schermata-2017-04-14-alle-10.27.51.png"><img class="aligncenter size-full wp-image-1949" src="https://i1.wp.com/www.zen.pn.it/wp-content/uploads/2017/04/Schermata-2017-04-14-alle-10.27.51.png?resize=455%2C659" alt="" width="455" height="659" srcset="https://i1.wp.com/www.zen.pn.it/wp-content/uploads/2017/04/Schermata-2017-04-14-alle-10.27.51.png?w=455 455w, https://i1.wp.com/www.zen.pn.it/wp-content/uploads/2017/04/Schermata-2017-04-14-alle-10.27.51.png?resize=110%2C160 110w, https://i1.wp.com/www.zen.pn.it/wp-content/uploads/2017/04/Schermata-2017-04-14-alle-10.27.51.png?resize=207%2C300 207w" sizes="(max-width: 455px) 100vw, 455px" data-recalc-dims="1" /></a></p>

<p> </p>

<h2 id="nota">Nota:</h2>

<p>In alcune installazioni è possibile che lo script non venga eseguito a causa delle restrizioni sulla firma digitale.</p>

<p>Se vi fidate del mio script potete disabilitare l’esecuzione del controllo digitando nella finestra power shell il comando:</p>

<pre>Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass</pre>

<h2 id="fonti">Fonti:</h2>

<ul>
  <li><a href="https://www.achab.it/achab.cfm/it/blog/achablog/come-usare-windows-auditing-per-fermare-i-cryptovirus">Come usare Windows Auditing per fermare i CryptoVirus</a></li>
  <li><a href="https://fsrm.experiant.ca/">Anti-Ransomware File System Resource Manager Lists</a></li>
  <li><a href="http://olivermarshall.net/using-file-screening-to-help-block-cryptolocker/">Updated: How to use File Screening to help block CryptoLocker</a></li>
  <li><a href="https://github.com/nexxai/CryptoBlocker">CryptoBlocker</a></li>
</ul>

			</div>

			
						<div id="page-meta" class="t30">
				<p>
					<!-- Look the author details up from the site config. -->
					
					<!-- Output author details if some exist. -->
					

				
				<time class="icon-calendar pr20" datetime="2017-04-14T12:33:33+02:00" itemprop="datePublished"> 2017-04-14</time>
				

				<span class="icon-archive pr20"> ARTICOLI</span>
				<br />
				<span class="pr20"></span>
			</p>

			
			<div id="post-nav" class="row">
				
				<div class="small-5 columns"><a class="button small radius prev" href="http://localhost:4000/2017/03/dati-banche-e-api-di-integrazione/">&laquo; Dati, banche e API di integrazione.</a></div><!-- /.small-4.columns -->
				
				<div class="small-2 columns text-center"><a class="radius button small" href="http://localhost:4000/archivio/" title="Blog Archivio">Archivio</a></div><!-- /.small-4.columns -->
				
				<div class="small-5 columns text-right"><a class="button small radius next" href="http://localhost:4000/2017/04/interessante-pubblicita-con-realta-aumentata/">Interessante pubblicità con &#8220;realtà aumentata&#8221; &raquo;</a></div><!-- /.small-4.columns -->
				
			</div>
			
			</div><!--  /.page-meta -->

			

			
		</article>
	</div><!-- /.medium-8.columns -->


	


	
</div><!-- /.row -->


	
	    <div id="up-to-top" class="row">
      <div class="small-12 columns" style="text-align: right;">
        <a class="iconfont" href="#top-of-page">&#xf108;</a>
      </div><!-- /.small-12.columns -->
    </div><!-- /.row -->


    <footer id="footer-content" class="bg-grau">
      <div id="footer">
        <div class="row">
          <div class="medium-6 large-5 columns">
            <h5 class="shadow-black">Informazioni su questo sito</h5>

            <p class="shadow-black">
              Segnalazioni e riflessioni su &quot;cose di tecnologia&quot; di Vittore Zen
              <a href="http://localhost:4000/perché-questo-blog/">Altro&nbsp;›</a>
            </p>
          </div><!-- /.large-6.columns -->


          <div class="small-6 medium-3 large-3 large-offset-1 columns">
            
              
                <h5 class="shadow-black">Servizi</h5>
              
            
              
            
              
            
              
            
              
            

              <ul class="no-bullet shadow-black">
              
                
                  <li >
                    <a href="http://localhost:4000"  title=""></a>
                  </li>
              
                
                  <li >
                    <a href="http://localhost:4000/contatti/"  title="Contatti">Contatti</a>
                  </li>
              
                
                  <li >
                    <a href="http://localhost:4000/feed.xml"  title="Subscribe to RSS Feed">RSS</a>
                  </li>
              
                
                  <li >
                    <a href="http://localhost:4000/atom.xml"  title="Subscribe to Atom Feed">Atom</a>
                  </li>
              
                
                  <li >
                    <a href="http://localhost:4000/sitemap.xml"  title="Sitemap for Google Webmaster Tools">sitemap.xml</a>
                  </li>
              
              </ul>
          </div><!-- /.large-4.columns -->


          <div class="small-6 medium-3 large-3 columns">
            
              
                <h5 class="shadow-black">Ringraziamenti</h5>
              
            
              
            
              
            
              
            

            <ul class="no-bullet shadow-black">
            
              
                <li >
                  <a href="http://localhost:4000"  title=""></a>
                </li>
            
              
                <li class="network-entypo" >
                  <a href="http://entypo.com/" target="_blank"  title="Icons by Daniel Bruce">Icons by Daniel Bruce</a>
                </li>
            
              
                <li class="services-newsletter" >
                  <a href="http://foundation.zurb.com/" target="_blank"  title="Built on Foundation">Built on Foundation</a>
                </li>
            
              
                <li class="rss-link" >
                  <a href="http://unsplash.com/" target="_blank"  title="Images by Unsplash">Images by Unsplash</a>
                </li>
            
            </ul>
          </div><!-- /.large-3.columns -->
        </div><!-- /.row -->

      </div><!-- /#footer -->


      <div id="subfooter">
        <nav class="row">
          <section id="subfooter-left" class="small-12 medium-6 columns credits">
            
          </section>

          <section id="subfooter-right" class="small-12 medium-6 columns">
            <ul class="inline-list social-icons">
            
              <li><a href="mailto:vittore@zen.pn.it" target="_blank" class="icon-mail" title=""></a></li>
            
              <li><a href="https://www.linkedin.com/in/vittorezen/" target="_blank" class="icon-linkedin" title=""></a></li>
            
              <li><a href="http://twitter.com/vittore" target="_blank" class="icon-twitter" title=""></a></li>
            
              <li><a href="http://www.facebook.com/vittore.zen" target="_blank" class="icon-facebook" title=""></a></li>
            
              <li><a href="http://github.com/vittore" target="_blank" class="icon-github" title=""></a></li>
            
            </ul>
          </section>
        </nav>
      </div><!-- /#subfooter -->
    </footer>

	

	


<script src="http://localhost:4000/assets/js/javascript.min.js"></script>














</body>
</html>

